"use strict";(self.webpackChunkselectdb_portal=self.webpackChunkselectdb_portal||[]).push([[50714],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>g});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=o.createContext({}),p=function(e){var t=o.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=p(e.components);return o.createElement(d.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=r,g=c["".concat(d,".").concat(u)]||c[u]||m[u]||i;return n?o.createElement(g,a(a({ref:t},s),{},{components:n})):o.createElement(g,a({ref:t},s))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=u;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l[c]="string"==typeof e?e:r,a[1]=l;for(var p=2;p<i;p++)a[p]=n[p];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},76926:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var o=n(87462),r=(n(67294),n(3905));const i={title:"Development and Debugging of Apache Doris BE -- Clion",language:"en"},a=void 0,l={unversionedId:"developer-guide/be-clion-dev",id:"developer-guide/be-clion-dev",title:"Development and Debugging of Apache Doris BE -- Clion",description:"\x3c!--",source:"@site/community/developer-guide/be-clion-dev.md",sourceDirName:"developer-guide",slug:"/developer-guide/be-clion-dev",permalink:"/community/developer-guide/be-clion-dev",draft:!1,tags:[],version:"current",frontMatter:{title:"Development and Debugging of Apache Doris BE -- Clion",language:"en"},sidebar:"community",previous:{title:"BE development and debugging environment under Linux",permalink:"/community/developer-guide/be-vscode-dev"},next:{title:"Dev & Debug prepare on Mac",permalink:"/community/developer-guide/mac-dev/dev-prepare"}},d={},p=[{value:"Downloading and Compiling Code on Remote Server",id:"downloading-and-compiling-code-on-remote-server",level:2},{value:"Clion Installation and Configuration for Remote Development Environment",id:"clion-installation-and-configuration-for-remote-development-environment",level:2},{value:"Running and debugging Doris BE remotely in Clion",id:"running-and-debugging-doris-be-remotely-in-clion",level:2}],s={toc:p},c="wrapper";function m(e){let{components:t,...i}=e;return(0,r.kt)(c,(0,o.Z)({},s,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"using-clion-for-remote-development-and-debugging-of-apache-doris-be"},"Using Clion for Remote Development and Debugging of Apache Doris BE"),(0,r.kt)("h2",{id:"downloading-and-compiling-code-on-remote-server"},"Downloading and Compiling Code on Remote Server"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Download Doris source code on the remote server, such as in the directory ",(0,r.kt)("inlineCode",{parentName:"li"},"/mnt/datadisk0/chenqi/doris"),"\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git clone https://github.com/apache/doris.git\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Modify the ",(0,r.kt)("inlineCode",{parentName:"p"},"env.sh")," file located in the root directory of the Doris code on the remote server.\nAdd the configuration for ",(0,r.kt)("inlineCode",{parentName:"p"},"DORIS_HOME")," at the beginning, for example, ",(0,r.kt)("inlineCode",{parentName:"p"},"DORIS_HOME=/mnt/datadisk0/chenqi/doris."))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Execute commands to compile the code. The detailed compilation process ",(0,r.kt)("a",{parentName:"p",href:"https://doris.apache.org/zh-CN/docs/dev/install/source-install/compilation-with-ldb-toolchain"},"compilation-with-ldb-toolchain"),"\u3002"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /mnt/datadisk0/chenqi/doris\n./build.sh\n")),(0,r.kt)("h2",{id:"clion-installation-and-configuration-for-remote-development-environment"},"Clion Installation and Configuration for Remote Development Environment"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Download and install Clion on your local env, then import the Doris BE source code.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Set up a remote development environment on your local env by navigating to ",(0,r.kt)("strong",{parentName:"p"},"Preferences -> Build, Execution, Deployment -> Deployment")," in Clion.\nAdd the connection and login information for the remote development server using ",(0,r.kt)("strong",{parentName:"p"},"SFTP")," and set the ",(0,r.kt)("strong",{parentName:"p"},"Mappings")," paths.\nFor example, where Local Path is the local path ",(0,r.kt)("inlineCode",{parentName:"p"},"/User/kaka/Programs/doris/be")," and Deployment Path is the remote server path ",(0,r.kt)("inlineCode",{parentName:"p"},"/mnt/datadisk0/chenqi/clion/doris/be"),"."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Deployment1",src:n(31828).Z,width:"2220",height:"1428"})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Deployment2",src:n(6387).Z,width:"2216",height:"1426"})),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"gensrc")," path on the remote server, for example ",(0,r.kt)("inlineCode",{parentName:"li"},"/mnt/datadisk0/chenqi/doris/gensrc"),", to the parent directory of the ",(0,r.kt)("strong",{parentName:"li"},"Deployment Path"),".\nFor example, the final directory path on the remote server should be ",(0,r.kt)("inlineCode",{parentName:"li"},"/mnt/datadisk0/chenqi/clion/doris/gensrc"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cp -R /mnt/datadisk0/chenqi/doris/gensrc /mnt/datadisk0/chenqi/clion/doris/gensrc\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"In Clion, navigate to ",(0,r.kt)("strong",{parentName:"li"},"Preferences -> Build, Execution, Deployment -> Toolchains")," and add the necessary remote environment toolchains such as cmake, gcc, g++, gdb, etc.\n",(0,r.kt)("strong",{parentName:"li"},"The most important step is to add the path of "),"env.sh",(0,r.kt)("strong",{parentName:"li"}," on the remote server to "),"Environment file",(0,r.kt)("strong",{parentName:"li"},"."))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Toolchains",src:n(22704).Z,width:"2226",height:"1416"})),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In Clion, modify ",(0,r.kt)("inlineCode",{parentName:"p"},"be/CmakeLists.txt")," and change ",(0,r.kt)("inlineCode",{parentName:"p"},"$ENV{JAVA_HOME}")," to the path of ",(0,r.kt)("inlineCode",{parentName:"p"},"JAVA_HOME")," on the remote server. (Otherwise, jni.h will not be found)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Right-click on ",(0,r.kt)("strong",{parentName:"p"},"Load Cmake Project")," in Clion. This will synchronize the code to the remote server and generate the Cmake build files."))),(0,r.kt)("h2",{id:"running-and-debugging-doris-be-remotely-in-clion"},"Running and debugging Doris BE remotely in Clion"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Configure CMake in ",(0,r.kt)("strong",{parentName:"p"},"Preferences -> Build, Execution, Deployment -> CMake"),". Different targets such as Debug / Release can be configured, and the ",(0,r.kt)("strong",{parentName:"p"},"ToolChain")," should be set to the previously configured.\nIf you want to run and debug Unit Tests, you need to add \xb7-DMAKE_TEST=ON\xb7 to CMake Options (this option is disabled by default, and needs to be enabled to compile the Test code)\nCopy the output directory in Doris source code to a separate path on the remote server, such as /mnt/datadisk0/chenqi/clion/doris/doris_be/.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Copy the output directory in Doris source code to a separate path on the remote server, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"/mnt/datadisk0/chenqi/clion/doris/doris_be/"),"."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cp -R /mnt/datadisk0/chenqi/doris/output /mnt/datadisk0/chenqi/clion/doris/doris_be\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Output Tree",src:n(42613).Z,width:"814",height:"310"})),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Select the relevant Target for doris_be in Clion, such as Debug or Release, and configure the run.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Run Debug Conf1",src:n(47114).Z,width:"2074",height:"1356"})),(0,r.kt)("p",null,"Refer to the environment variables exported in ",(0,r.kt)("inlineCode",{parentName:"p"},"be/bin/start_be.sh")," in the Doris root directory for environment variable configuration. The value of each environment variable should point to the corresponding path on the remote server.**\nEnvironment variables reference:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Run Debug Conf2",src:n(67540).Z,width:"3118",height:"796"})),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Click ",(0,r.kt)("strong",{parentName:"li"},"Run")," to compile and run the BE, or click ",(0,r.kt)("strong",{parentName:"li"},"Debug")," to compile and debug the BE.")))}m.isMDXComponent=!0},31828:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/clion-deployment1-a36f51febb0818fed20a02a71b697a5a.png"},6387:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/clion-deployment2-5887d4af6d031a8b484cc0dcb6399837.png"},47114:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/clion-run-debug-conf1-e57278a1580b0b96f3a9016924613981.png"},67540:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/clion-run-debug-conf2-abdc543704be6a69328c6985b0c7a36f.png"},22704:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/clion-toolchains-6160ba355a369c4a39be6dae1bede1fb.png"},42613:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/doris-dist-output-tree-e5e484ba7fe826861a853756e9cb3cdc.png"}}]);